@using AppData.Models;
@model AppView.Models.DetailsProductViewModel
@inject IHttpContextAccessor HttpContextAccessor
@{
    ViewData["Title"] = "Details";
    var shoesDetails = ViewBag.shoesList as List<ShoesDetails>;
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/owl.carousel.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="~/css/detail.css">
    <link href="https://unpkg.com/tailwindcss@0.3.0/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css'>
    <link rel="icon" href="img/mdb-favicon.ico" type="image/x-icon" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <!-- Google Fonts Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <title>Detail</title>
    <style>
        .product-small-img img {
            height: 92px;
            margin: 10px 0;
            cursor: pointer;
            display: block;
            opacity: .6;
            border-radius: 10%;
        }

            .product-small-img img:hover {
                opacity: 1;
            }

        .product-small-img {
            float: left;
            margin-left: 27%;
        }

        .product {
            position: relative;
        }

        .img-container img {
            height: 500px;
            border-radius: 2%;
        }

        .img-container {
            float: right;
            padding: 10px;
        }

        .delete-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgb(20, 20, 20);
            border: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.164);
            cursor: pointer;
            transition-duration: 0.3s;
            overflow: hidden;
            position: relative;
            top: -70px;
            margin-left: 70%;
        }

        .delete-svgIcon {
            width: 15px;
            transition-duration: 0.3s;
        }

            .delete-svgIcon path {
                fill: white;
            }

        .delete-button-next {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgb(20, 20, 20);
            border: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.164);
            cursor: pointer;
            transition-duration: 0.3s;
            overflow: hidden;
            position: relative;
            top: -110px;
            margin-left: 83%;
        }

        .delete-svgIcon-next {
            width: 15px;
            transition-duration: 0.3s;
        }

            .delete-svgIcon-next path {
                fill: white;
            }

        :root {
            --primary-color: #007bff;
            --primary-hover: #0056b3;
            --background-color: #ffffff;
            --surface-color: #f8f9fa;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --border-color: #dee2e6;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 8px 30px rgba(0, 0, 0, 0.15);
            --user-message-bg: #007bff;
            --user-message-text: #ffffff;
            --bot-message-bg: #f1f3f4;
            --bot-message-text: #212529;
            --input-bg: #ffffff;
            --typing-bg: #e9ecef;
        }
        /* Chatbot Widget */
        .chatbot-widget {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
        }

        .chat-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: black;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin-left: 95%;
        }

            .chat-toggle:hover {
                transform: translateY(-2px);
                box-shadow: var(--shadow-hover);
            }

            .chat-toggle svg {
                width: 24px;
                height: 24px;
                transition: all 0.3s ease;
            }

            .chat-toggle .close-icon {
                position: absolute;
                opacity: 0;
                transform: rotate(90deg);
            }

        .chatbot-widget.open .chat-toggle .chat-icon {
            opacity: 0;
            transform: rotate(-90deg);
        }

        .chatbot-widget.open .chat-toggle .close-icon {
            opacity: 1;
            transform: rotate(0deg);
        }

        /* Chat Container */
        .chat-container {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 380px;
            height: 500px;
            background: var(--surface-color);
            border-radius: 16px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--border-color);
        }

        .chatbot-widget.open .chat-container {
            transform: translateY(0) scale(1);
            opacity: 1;
            visibility: visible;
        }

        /* Chat Header */
        .chat-header {
            background: var(--background-color);
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .bot-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .bot-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            color: black;
            border: 1px solid black;
        }

            .bot-avatar svg {
                width: 20px;
                height: 20px;
            }

        .bot-details h3 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .status {
            font-size: 0.75rem;
            color: #10b981;
            font-weight: 500;
        }

        .chat-controls {
            display: flex;
            gap: 0.5rem;
        }

        .minimize-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: var(--input-bg);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

            .minimize-btn:hover {
                background: black;
                color: white;
                transform: translateY(-1px);
            }

            .minimize-btn svg {
                width: 16px;
                height: 16px;
            }

        /* Chat Messages */
        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            scroll-behavior: smooth;
        }

            .chat-messages::-webkit-scrollbar {
                width: 4px;
            }

            .chat-messages::-webkit-scrollbar-track {
                background: transparent;
            }

            .chat-messages::-webkit-scrollbar-thumb {
                background: var(--border-color);
                border-radius: 2px;
            }

        .message {
            display: flex;
            gap: 0.75rem;
            animation: fadeInUp 0.4s ease;
        }

        .user-message {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .bot-message .message-avatar {
            background: white;
            color: black;
            border: 1px solid black;
        }

        .user-message .message-avatar {
            background: #E0F2FE;
            color: black;
        }

        .message-avatar svg {
            width: 16px;
            height: 16px;
        }

        .message-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .user-message .message-content {
            align-items: flex-end;
        }

        .message-bubble {
            padding: 0.75rem 1rem;
            border-radius: 16px;
            max-width: 85%;
            word-wrap: break-word;
            line-height: 1.5;
        }

        .bot-message .message-bubble {
            background: black;
            color: white;
            border-bottom-left-radius: 4px;
        }

        .user-message .message-bubble {
            background: #E0F2FE;
            color: black;
            border-bottom-right-radius: 4px;

        }

        .message-time {
            font-size: 0.7rem;
            color: var(--text-secondary);
            padding: 0 0.5rem;
        }

        /* Typing Indicator */
        .typing-indicator {
            padding: 0 1rem;
            display: none;
            align-items: center;
            gap: 0.75rem;
            animation: fadeInUp 0.4s ease;
        }

            .typing-indicator.show {
                display: flex;
            }

        .typing-bubble {
            background: var(--typing-bg);
            padding: 0.75rem 1rem;
            border-radius: 16px;
            border-bottom-left-radius: 4px;
        }

        .typing-dots {
            display: flex;
            gap: 0.25rem;
        }

            .typing-dots span {
                width: 6px;
                height: 6px;
                background: var(--text-secondary);
                border-radius: 50%;
                animation: typingAnimation 1.4s infinite ease-in-out;
            }

                .typing-dots span:nth-child(2) {
                    animation-delay: 0.2s;
                }

                .typing-dots span:nth-child(3) {
                    animation-delay: 0.4s;
                }

        /* Chat Input */
        .chat-input {
            padding: 1rem;
            border-top: 1px solid var(--border-color);
            background: var(--background-color);
        }

        .input-container {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        #messageInput {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 24px;
            background: var(--input-bg);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            outline: none;
            transition: all 0.3s ease;
        }

            #messageInput:focus {
                border-color: var(--primary-color);
                box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
            }

            #messageInput::placeholder {
                color: var(--text-secondary);
            }

        .send-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: black;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

            .send-btn:hover:not(:disabled) {
                background: var(--primary-hover);
                transform: translateY(-1px);
            }

            .send-btn:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            .send-btn svg {
                width: 18px;
                height: 18px;
            }
    </style>
</head>

<body>
    <div class="container mt-4 d-flex justify-content-center" style="padding-top: 45px;">
        <div class="row g-0">
            <!-- src="image/anh11.png" -->
            <div class="col-12 col-sm-12 col-md-7 col-lg-7">
                <div class="product">
                    <div class="product-small-img d-none d-sm-none d-md-none d-lg-none d-xl-block">
                        <img src="@Url.Content("~/image/" + ViewBag.ImageGolden1)" alt="Product Image" class="img-fluid" style="width: 100%;" onmouseover="hoverThumbnail(this)" onmouseout="resetThumbnailOpacity(this)">
                        <img src="@Url.Content("~/image/" + ViewBag.ImageGolden2)" alt="Product Image" class="img-fluid" style="width: 100%;" onmouseover="hoverThumbnail(this)" onmouseout="resetThumbnailOpacity(this)">
                        <img src="@Url.Content("~/image/" + ViewBag.ImageGolden3)" alt="Product Image" class="img-fluid" style="width: 100%;" onmouseover="hoverThumbnail(this)" onmouseout="resetThumbnailOpacity(this)">
                        <img src="@Url.Content("~/image/" + ViewBag.ImageGolden4)" alt="Product Image" class="img-fluid" style="width: 100%;" onmouseover="hoverThumbnail(this)" onmouseout="resetThumbnailOpacity(this)">
                    </div> 
                    <div class="img-container">
                        <img id="imageBox" src="@Url.Content("~/image/" + ViewBag.ImageGolden1)" alt="Product Image" class="img-fluid" style="width: 100%;">
                        <button class="delete-button" onclick="previousImage()">
                            <svg class="delete-svgIcon" viewBox="0 0 20 20">
                                <path fill="none" d="M8.388,10.049l4.76-4.873c0.303-0.31,0.297-0.804-0.012-1.105c-0.309-0.304-0.803-0.293-1.105,0.012L6.726,9.516c-0.303,0.31-0.296,0.805,0.012,1.105l5.433,5.307c0.152,0.148,0.35,0.223,0.547,0.223c0.203,0,0.406-0.08,0.559-0.236c0.303-0.309,0.295-0.803-0.012-1.104L8.388,10.049z"></path>
                            </svg>
                        </button>
                        <button class="delete-button-next" onclick="nextImage()">
                            <svg class="delete-svgIcon-next" viewBox="0 0 20 20">
                                <path fill="none" d="M11.611,10.049l-4.76-4.873c-0.303-0.31-0.297-0.804,0.012-1.105c0.309-0.304,0.803-0.293,1.105,0.012l5.306,5.433c0.304,0.31,0.296,0.805-0.012,1.105L7.83,15.928c-0.152,0.148-0.35,0.223-0.547,0.223c-0.203,0-0.406-0.08-0.559-0.236c-0.303-0.309-0.295-0.803-0.012-1.104L11.611,10.049z"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <script>
                var imageUrls = [
                    "@Url.Content("~/image/" + ViewBag.ImageGolden1)",
                    "@Url.Content("~/image/" + ViewBag.ImageGolden2)",
                    "@Url.Content("~/image/" + ViewBag.ImageGolden3)",
                    "@Url.Content("~/image/" + ViewBag.ImageGolden4)"
                ];

                var currentImageIndex = 0;

                function nextImage() {
                    currentImageIndex = (currentImageIndex + 1) % imageUrls.length;
                    updateImage();
                    updateThumbnails();
                }

                function previousImage() {
                    currentImageIndex = (currentImageIndex - 1 + imageUrls.length) % imageUrls.length;
                    updateImage();
                    updateThumbnails();
                }

                function updateImage() {
                    var fullImg = document.getElementById("imageBox");
                    fullImg.src = imageUrls[currentImageIndex];
                }

                function updateThumbnails() {
                    var thumbnails = document.querySelectorAll(".product-small-img img");
                    for (var i = 0; i < thumbnails.length; i++) {
                        if (i === currentImageIndex) {
                            thumbnails[i].style.opacity = 1;
                        } else {
                            thumbnails[i].style.opacity = 0.6;
                        }
                    }
                }

                function hoverThumbnail(thumbnail) {
                    var fullImg = document.getElementById("imageBox");
                    var index = Array.from(thumbnail.parentNode.children).indexOf(thumbnail);
                    fullImg.src = imageUrls[index];
                    thumbnail.style.opacity = 1;
                }

                function resetThumbnailOpacity(thumbnail) {
                    var index = Array.from(thumbnail.parentNode.children).indexOf(thumbnail);
                    if (index !== currentImageIndex) {
                        thumbnail.style.opacity = 0.6;
                    }
                }
                updateThumbnails();
            </script>
            <!-- src="image/video1.mp4" -->
            <div class="col-12 col-sm-12 col-md-5 col-lg-5" style="margin-top:-6%;">
                <div class="product p-6 p-md-5">
                    <div class="mt-4 mb-3">
                        <span class="text-uppercase text-muted brand" style="font-size: 11px;">
                            Sustainable
                            Materials
                        </span>
                        <h5 class="text-uppercase" style="padding-top: 5px;">@ViewBag.nameProduct</h5>
                        <!-- Nike SuperRep Cycle 2 Next Nature -->
                        <!-- Indoor Cycling Shoes -->
                        <p class="line1" style="padding-top: 5px; font-weight:bold;">Kiểu dáng: @ViewBag.styleProduct</p>
                        <p style="font-size: 14px; padding-top: 5px; font-weight:bold;">Giá: @Model.Price.ToString("N0")đ</p>
                        <p style="font-size: 14px; padding-top: 5px;">Sản phẩm có sẵn: <span style="font-weight:bold;" id="quantity"></span></p>
                        <p style="font-size: 14px; padding-top: 5px;">Chiều dài chân phù hợp: <span style="font-weight:bold;" id="result"></span></p>
                    </div>
                    <h6 class="text-uppercase" style="font-size: 12px;">Select Size</h6>
                    <div class="cart mt-4 align-items-center">
                        <form method="post" action="@Url.Action("AddToCart", "Cart", new { id = Model.ShoesDetailsId })">
                            <div class="label1" style="padding-top: 5px;">
                                <label class="radio">
                                    <input type="radio" name="size" value="34" checked> <span class="span1">34</span>
                                </label>
                                <label class="radio">
                                    <input type="radio" name="size" value="35"> <span class="span1">35</span>
                                </label>
                                <label class="radio">
                                    <input type="radio" name="size" value="36"> <span class="span1">36</span>
                                </label>
                                <label class="radio">
                                    <input type="radio" name="size" value="37"> <span class="span2">37</span>
                                </label>
                                <label class="radio">
                                    <input type="radio" name="size" value="38"> <span class="span2">38</span>
                                </label>
                                <label class="radio">
                                    <input type="radio" name="size" value="39"> <span class="span2">39</span>
                                </label>
                                <label class="radio">
                                    <input type="radio" name="size" value="40"> <span class="span3">40</span>
                                </label>
                                <label class="radio">
                                    <input type="radio" name="size" value="41"> <span class="span3">41</span>
                                </label>
                                <label class="radio">
                                    <input type="radio" name="size" value="42"> <span class="span3">42</span>
                                </label>
                            </div>
                            <button type="submit" id="addToCartButton" class="btn btn-danger text mr-2 px-4" style="width: 79%; border-radius: 20px; color: white; margin-top:10px;">Add to cart</button>
                        </form>
                        <script>
                            document.addEventListener("DOMContentLoaded", function () {
                                // Lấy danh sách radio button theo tên "size"
                                const sizeRadios = document.getElementsByName("size");
                                // Lựa chọn size mặc định (ví dụ: size đầu tiên)
                                const defaultSize = sizeRadios[0].value;

                                // Gọi hàm để cập nhật thông tin số lượng và chiều dài chân ngay khi trang được load
                                updateQuantityAndFootLength(defaultSize);

                                // Lắng nghe sự kiện click trên radio button
                                for (let i = 0; i < sizeRadios.length; i++) {
                                    sizeRadios[i].addEventListener("click", function () {
                                        const selectedSize = this.value;
                                        // Gọi hàm để cập nhật thông tin số lượng và chiều dài chân dựa trên size đã chọn
                                        updateQuantityAndFootLength(selectedSize);
                                    });
                                }
                            });

                            function updateQuantityAndFootLength(size) {
                                const quantitySpan = document.getElementById('quantity');
                                const addToCartButton = document.getElementById('addToCartButton');

                                // Gửi yêu cầu Ajax để lấy số lượng và chiều dài chân dựa trên kích thước và ShoesDetailsId
                                $.get('@Url.Action("GetQuantityForSize", "Home")', { shoesDetailsId: "@Model.ShoesDetailsId", sizeForm: size }, function (data) {
                                    // Cập nhật nội dung của quantitySpan bằng số lượng tồn từ phản hồi.
                                    quantitySpan.textContent = data.quantity;
                                    const soluong = data.quantity;
                                    if (soluong <= 0) {
                                        addToCartButton.disabled = true;
                                        addToCartButton.textContent = "Hết hàng";
                                    } else {
                                        addToCartButton.disabled = false;
                                        addToCartButton.textContent = "Add To Cart";
                                    }

                                    const result = document.getElementById("result");
                                    result.textContent = getFootLength(size) + " cm";
                                });
                            }

                            function getFootLength(size) {
                                const footLengths = {
                                    "34": 21.5,
                                    "35": 22,
                                    "36": 23,
                                    "37": 23.5,
                                    "38": 24,
                                    "39": 25,
                                    "40": 25.5,
                                    "41": 26,
                                    "42": 27,
                                };
                                return footLengths[size] || "Không rõ";
                            }
                        </script>
                    </div>
                    <div class="chu1">
                        <hr style="width:77%;" />
                        <h5 onclick="toggleDescription()" style="width:77%;">Thông tin chi tiết sản phẩm <img src="~/image/icons8-chevron-down-11.png" style="float:right; padding-top:5px;" id="imgMoTa" /></h5>
                        <p class="about" style="font-size: 13px; margin-top: 5px; text-align: justify; display:none; width:77%;" id="description">
                       
                            
                            <strong>Mô tả:</strong> @Model.Description<br />
                          
                            <div class="additional-info" >
                                <strong>🎀 Đặc tính nổi bật:</strong>
                                <ul>
                                    <li>Kháng nước nhẹ khi đi mưa</li>
                                    <li>Đế và lót được khâu toàn bộ tránh bung keo</li>
                                    <li>Nhiều phiên bản màu sắc</li>
                                    <li>Thích hợp sử dụng với nhiều hoạt động thể thao, vui chơi,...</li>
                                </ul>
                                <strong>🎀 Hướng dẫn sử dụng:</strong>
                                <ul>
                                    <li>Bảo quản nơi khô ráo tránh ẩm mốc sản phẩm</li>
                                    <li>Không giặt giày với nước nhiệt độ cao</li>
                                    <li>Khuyến cáo sử dụng thêm sản phẩm vệ sinh giày của shop để tăng tuổi thọ cho sản phẩm</li>
                                </ul>
                                <strong>🎀 Cách tìm mua sản phẩm @ViewBag.nameProduct:</strong> Vào ô tìm kiếm của Shop gõ từ khóa "@ViewBag.nameProduct". <br />
                                <strong>🎀 Hotline:</strong> 0766900008
                            </div>
                        </p>
                    </div>
                    <script>
                        function toggleDescription() {
                            var description = document.getElementById("description");
                            var img = document.getElementById("imgMoTa");
                            if (description.style.display === "none") {
                                description.style.display = "block";
                                img.src = "/image/icons8-chevron-up-11.png";
                            } else {
                                description.style.display = "none";
                                img.src = "/image/icons8-chevron-down-11.png";
                            }
                        }
                    </script>
                </div>
            </div>
            <!-- Chatbot Widget -->
            <div class="chatbot-widget" id="chatbotWidget">
                <!-- Chat Toggle Button -->
                <button class="chat-toggle" id="chatToggle" aria-label="Toggle Chat">
                    <svg class="chat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                    </svg>
                    <svg class="close-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>

                <!-- Chat Container -->
                <div class="chat-container" id="chatContainer">
                    <!-- Chat Header -->
                    <div class="chat-header">
                        <div class="bot-info">
                            <div class="bot-avatar">
                                @*<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="8" r="5" />
                                    <path d="M20 21a8 8 0 1 0-16 0" />
                                </svg>*@
                                 <svg version="1.0" xmlns="http://www.w3.org/2000/svg"  width="280.000000pt" height="340.000000pt" viewBox="0 0 240.000000 300.000000"  preserveAspectRatio="xMidYMid meet">  <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none"> <path d="M1385 2738 c-218 -53 -266 -70 -570 -209 -225 -103 -238 -111 -257 -149 -23 -47 -11 -90 47 -169 43 -59 117 -113 174 -128 30 -7 268 112 338 170 25 20 54 37 64 37 11 0 36 8 57 19 37 18 179 56 327 87 121 25 255 7 255 -35 0 -30 -75 -169 -129 -241 -64 -85 -300 -333 -522 -549 -96 -94 -206 -208 -245 -253 -38 -45 -116 -131 -174 -192 -158 -167 -413 -469 -438 -519 -19 -38 -10 -74 39 -158 56 -97 92 -135 144 -152 39 -14 51 -14 107 -1 35 8 88 30 119 49 94 57 280 153 354 180 145 55 418 116 602 134 73 8 103 22 103 48 0 10 7 14 20 10 13 -3 30 5 51 24 17 16 37 29 45 29 9 0 14 11 14 30 0 35 22 40 53 12 19 -16 20 -16 8 5 -6 13 -23 26 -36 29 -20 5 -25 12 -25 38 0 38 -31 72 -81 87 -19 6 -112 13 -208 16 -185 6 -276 -2 -439 -39 -51 -12 -95 -18 -98 -15 -9 8 171 200 465 496 310 314 483 521 545 653 23 51 31 150 17 223 -18 96 -66 180 -156 271 -84 85 -152 128 -254 158 -61 18 -249 21 -316 4z m311 -47 c33 -10 79 -29 104 -42 61 -32 196 -162 217 -210 9 -21 20 -39 24 -39 4 0 13 -26 19 -57 6 -32 15 -72 19 -89 11 -42 -10 -137 -45 -199 -22 -40 -75 -115 -141 -200 -31 -39 -142 -163 -160 -178 -13 -10 -23 -24 -23 -32 0 -7 -11 -20 -25 -29 -36 -24 -185 -172 -185 -185 0 -6 -8 -15 -18 -20 -24 -13 -209 -198 -311 -310 -42 -47 -93 -100 -113 -119 -21 -19 -38 -39 -38 -44 0 -6 -19 -27 -42 -48 -24 -21 -40 -42 -35 -46 4 -4 38 3 74 15 197 68 384 95 588 87 236 -9 275 -19 275 -71 0 -21 -2 -22 -47 -13 -52 9 -97 3 -88 -12 3 -6 19 -10 35 -10 16 0 31 -4 34 -9 3 -5 15 -7 25 -4 22 5 61 -13 61 -28 0 -6 -9 -8 -19 -4 -13 4 -23 0 -31 -12 -8 -13 -13 -14 -16 -5 -3 6 -12 12 -20 12 -8 0 -17 7 -21 16 -5 15 -7 15 -15 0 -7 -13 -28 -16 -109 -16 -76 0 -100 -3 -96 -12 3 -10 35 -12 120 -11 89 2 117 -1 117 -11 0 -7 -16 -18 -35 -26 -19 -8 -35 -17 -35 -22 0 -12 -108 -10 -115 3 -5 7 -14 4 -25 -9 -14 -15 -38 -21 -97 -26 -43 -4 -89 -11 -103 -16 -14 -4 -59 -16 -100 -25 -41 -10 -121 -33 -176 -51 -56 -19 -107 -34 -114 -34 -8 0 -21 -7 -30 -15 -15 -14 -97 -58 -295 -158 -90 -46 -157 -66 -163 -49 -2 7 -13 12 -23 12 -19 0 -89 66 -89 84 0 4 -16 34 -35 66 -19 32 -35 68 -35 80 0 12 25 50 58 88 33 37 66 77 74 90 8 12 44 55 79 94 35 39 69 78 75 87 7 9 30 36 53 60 23 24 41 47 41 51 0 4 10 12 23 19 12 6 33 27 46 46 13 19 39 44 57 56 19 11 37 31 40 43 3 13 30 47 60 77 30 29 54 59 54 66 0 7 4 13 8 13 23 0 626 619 717 734 56 72 135 219 135 252 0 8 4 23 9 33 5 9 7 22 3 28 -10 16 -126 43 -183 43 -40 0 -49 3 -49 18 -1 16 -2 16 -14 -1 -9 -12 -47 -25 -108 -38 -51 -11 -109 -24 -128 -29 -19 -5 -53 -13 -75 -18 -22 -5 -59 -18 -82 -30 -43 -23 -113 -30 -113 -12 0 6 -5 10 -11 10 -8 0 -7 -5 1 -16 11 -13 9 -20 -16 -44 -45 -44 -296 -176 -316 -166 -56 26 -112 68 -140 106 -81 111 -79 140 15 183 21 9 42 17 48 17 8 0 186 82 272 126 16 8 37 14 46 14 10 0 26 9 35 19 10 10 33 22 53 26 19 3 43 10 52 15 26 14 143 49 181 54 19 3 49 9 65 15 55 17 227 13 291 -8z"/> <path d="M1015 2311 c-10 -17 12 -21 25 -6 10 12 10 15 -3 15 -9 0 -18 -4 -22 -9z"/> <path d="M1928 2042 c-10 -2 -18 -12 -18 -23 0 -23 13 -25 30 -4 15 19 10 32 -12 27z"/>
                                 <path d="M1830 2020 c0 -11 4 -20 9 -20 11 0 22 26 14 34 -12 12 -23 5 -23 -14z"/> <path d="M1875 1970 c-3 -11 -10 -20 -14 -20 -4 0 -13 -11 -19 -25 -6 -14 -18 -25 -26 -25 -7 0 -16 -9 -19 -20 -3 -11 -12 -20 -21 -20 -20 0 -21 -14 -2 -29 18 -15 53 18 81 77 13 28 25 41 35 39 11 -3 17 4 18 19 2 30 -24 32 -33 4z"/> <path d="M1638 1883 c-2 -5 -3 -20 -3 -35 0 -42 20 -38 22 5 2 32 -10 51 -19 30z"/> <path d="M1637 1794 c-9 -9 4 -35 14 -28 5 3 9 12 9 20 0 14 -12 19 -23 8z"/> <path d="M1693 1774 c-13 -14 -23 -28 -23 -30 0 -9 79 -3 85 6 3 6 -1 10 -10 10 -12 0 -15 6 -10 20 9 29 -15 25 -42 -6z"/> <path d="M1548 1766 c-18 -13 -14 -26 8 -26 14 0 27 27 16 34 -4 2 -15 -1 -24 -8z"/> <path d="M1495 1720 c-8 -12 20 -24 35 -15 6 3 8 11 5 16 -8 12 -32 12 -40 -1z"/> <path d="M1640 1704 c0 -9 7 -14 17 -12 25 5 28 28 4 28 -12 0 -21 -6 -21 -16z"/> <path d="M1579 1653 c-50 -56 -54 -63 -30 -63 11 0 21 6 21 13 0 8 16 22 35 33 35 19 41 37 14 42 -8 1 -26 -10 -40 -25z"/> <path d="M1465 1619 c-10 -15 3 -25 16 -12 7 7 7 13 1 17 -6 3 -14 1 -17 -5z"/> <path d="M1299 1584 c-12 -14 -11 -16 5 -13 11 2 21 10 24 17 5 17 -13 15 -29 -4z"/> <path d="M1482 1555 c-38 -32 -41 -45 -9 -45 15 0 29 9 36 24 22 41 9 51 -27 21z"/> <path d="M1422 1559 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z"/> <path d="M1342 1528 c-17 -17 -15 -28 6 -28 19 0 42 18 42 32 0 12 -35 9 -48 -4z"/> <path d="M1429 1481 c-49 -31 -101 -79 -98 -90 3 -7 19 -1 41 14 20 14 50 25 67 25 16 0 33 5 36 10 4 6 -5 10 -21 10 -26 0 -27 0 -9 20 24 26 17 31 -16 11z"/> <path d="M1273 1473 c-7 -2 -13 -11 -13 -20 0 -20 34 -12 38 10 3 17 -3 20 -25 10z"/> <path d="M1186 1446 c7 -17 54 -23 54 -6 0 6 -6 10 -14 10 -8 0 -22 3 -30 6 -12 5 -15 2 -10 -10z"/> <path d="M1182 1388 c6 -18 28 -21 28 -4 0 9 -7 16 -16 16 -9 0 -14 -5 -12 -12z"/> <path d="M1330 1359 c0 -6 -7 -8 -16 -5 -17 6 -44 -9 -44 -25 0 -5 13 -9 29 -9 31 0 65 25 56 41 -8 13 -25 11 -25 -2z"/> <path d="M1035 1309 c-4 -6 -5 -13 -2 -16 7 -7 27 6 27 18 0 12 -17 12 -25 -2z"/> <path d="M1237 1314 c-8 -8 1 -24 14 -24 5 0 9 7 9 15 0 15 -12 20 -23 9z"/> <path d="M1145 1289 c-10 -15 3 -25 16 -12 7 7 7 13 1 17 -6 3 -14 1 -17 -5z"/> <path d="M1198 1267 c-31 -24 -168 -190 -168 -203 0 -8 -9 -14 -19 -14 -20 0 -101 -84 -101 -105 0 -22 13 -25 28 -4 11 16 17 17 28 8 9 -7 14 -8 14 -1 0 6 -5 14 -11 18 -7 4 -1 17 17 35 21 22 33 27 52 22 23 -5 24 -4 18 20 -5 20 1 33 30 64 92 98 120 123 137 123 13 0 17 6 15 22 -4 26 -18 31 -40 15z"/> <path d="M1047 1238 c-18 -9 -24 -38 -8 -38 5 0 19 8 31 18 18 15 20 20 8 24 -8 3 -22 2 -31 -4z"/> <path d="M978 1193 c-14 -2 -29 -11 -32 -20 -8 -21 1 -30 16 -15 7 7 23 12 36 12 21 0 23 -2 12 -15 -15 -18 -7 -30 14 -22 20 8 16 61 -4 63 -8 1 -27 -1 -42 -3z"/> <path d="M870 1060 c0 -12 50 -33 58 -25 7 7 -29 34 -45 35 -7 0 -13 -5 -13 -10z"/> <path d="M797 1034 c-10 -11 3 -24 24 -24 10 0 19 7 19 15 0 15 -31 21 -43 9z"/> <path d="M766 954 c-9 -24 -8 -24 19 -12 14 6 25 15 25 20 0 15 -38 8 -44 -8z"/> <path d="M785 920 c-3 -5 -12 -7 -20 -3 -8 3 -15 0 -15 -6 0 -6 -7 -11 -15 -11 -8 0 -15 -4 -15 -9 0 -16 21 -24 33 -12 6 6 21 11 34 11 16 0 23 6 23 20 0 21 -15 27 -25 10z"/> <path d="M852 889 c-7 -12 -12 -22 -10 -22 2 -1 14 -8 26 -15 27 -15 42 -8 24 10 -7 7 -12 20 -12 30 0 24 -12 23 -28 -3z"/> <path d="M1656 864 c-4 -9 -4 -19 -1 -23 8 -7 38 12 43 27 6 19 -35 14 -42 -4z"/>
                                 <path d="M722 836 c1 -10 8 -17 13 -17 15 1 12 24 -3 29 -9 3 -13 -2 -10 -12z"/> <path d="M805 840 c-8 -13 3 -50 16 -50 5 0 9 9 9 20 0 11 0 23 1 27 1 12 -19 15 -26 3z"/> <path d="M1548 839 c-16 -9 -26 -39 -13 -39 15 0 54 33 49 41 -7 11 -15 11 -36 -2z"/> <path d="M675 820 c-4 -6 -15 -8 -26 -5 -13 4 -19 2 -19 -9 0 -11 9 -16 29 -16 29 0 57 21 44 33 -9 10 -21 8 -28 -3z"/> <path d="M1395 820 c-4 -6 -3 -16 3 -22 6 -6 12 -6 17 2 4 6 3 16 -3 22 -6 6 -12 6 -17 -2z"/> <path d="M757 784 c-11 -14 -16 -28 -13 -31 7 -7 56 36 56 49 0 17 -26 6 -43 -18z"/> <path d="M1182 799 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z"/> <path d="M663 761 c-13 -21 -8 -32 13 -24 14 5 20 43 6 43 -4 0 -13 -9 -19 -19z"/>
                                 <path d="M1120 765 c0 -8 5 -15 10 -15 6 0 10 7 10 15 0 8 -4 15 -10 15 -5 0 -10 -7 -10 -15z"/> <path d="M1510 770 c-12 -8 -9 -10 13 -10 15 0 27 5 27 10 0 13 -20 13 -40 0z"/> <path d="M1315 749 c-4 -6 -5 -13 -2 -16 7 -7 27 6 27 18 0 12 -17 12 -25 -2z"/> <path d="M1263 743 c-18 -7 -16 -23 2 -23 8 0 15 7 15 15 0 8 -1 15 -2 14 -2 0 -9 -3 -15 -6z"/> <path d="M1404 726 c-22 -17 -13 -32 13 -21 10 4 37 7 61 7 30 0 42 4 42 14 0 19 -89 19 -116 0z"/> <path d="M1530 730 c0 -5 11 -10 25 -10 14 0 25 5 25 10 0 6 -11 10 -25 10 -14 0 -25 -4 -25 -10z"/> <path d="M1342 699 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z"/> <path d="M1236 675 c-3 -9 0 -15 9 -15 8 0 15 7 15 15 0 8 -4 15 -9 15 -5 0 -11 -7 -15 -15z"/> <path d="M1136 672 c-9 -15 16 -42 38 -42 9 0 16 7 16 15 0 8 -9 15 -19 15 -11 0 -21 5 -23 12 -3 9 -6 9 -12 0z"/> <path d="M1050 620 c0 -15 7 -20 29 -20 17 0 31 6 35 16 9 24 7 28 -8 15 -10 -8 -16 -9 -21 -1 -11 18 -35 11 -35 -10z"/> <path d="M936 584 c-5 -12 -2 -15 10 -10 8 3 20 6 25 6 5 0 9 5 9 10 0 16 -37 11 -44 -6z"/> <path d="M891 546 c-8 -10 -9 -16 -1 -21 5 -3 13 1 16 10 9 22 -1 29 -15 11z"/> <path d="M740 540 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z"/> <path d="M835 511 c-3 -5 -1 -12 4 -15 12 -8 41 3 41 15 0 12 -37 12 -45 0z"/> <path d="M720 440 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z"/> <path d="M1948 783 c-10 -2 -18 -9 -18 -14 0 -14 16 -11 30 6 7 8 11 14 9 14 -2 -1 -12 -3 -21 -6z"/> </g> </svg>
                            </div>
                            <div class="bot-details">
                                <h3>Trợ lý AI ZenSports</h3>
                                <span class="status">Online</span>
                            </div>
                        </div>
                        <div class="chat-controls">
                            <button class="minimize-btn" id="minimizeBtn" aria-label="Minimize Chat">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="5" y1="12" x2="19" y2="12" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Chat Messages -->
                    <div class="chat-messages" id="chatMessages">
                        @if (Model.ChatHistory != null && Model.ChatHistory.Any())
                        {
                            @foreach (var item in Model.ChatHistory.OrderBy(c => c.CreatedAt))
                            {
                                if (!string.IsNullOrWhiteSpace(item.Message)) //chat của người dùng
                                {
                                    <div class="message user-message">
                                        <div class="message-avatar ">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <circle cx="12" cy="8" r="5" />
                                                <path d="M20 21a8 8 0 1 0-16 0" />
                                            </svg>
                                        </div>
                                        <div class="message-content">
                                            <div class="message-bubble">
                                                <p>@Html.Raw(item.Message.Replace("\n", "<br/>"))</p>
                                            </div>
                                        </div>
                                    </div>
                                }

                                if (!string.IsNullOrWhiteSpace(item.Response)) //chat phản hồi từ AI
                                {
                                    <div class="message bot-message">
                                        <div class="message-avatar">
                                            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="280.000000pt" height="340.000000pt" viewBox="0 0 240.000000 300.000000" preserveAspectRatio="xMidYMid meet">
                                                <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
                                                    <path d="M1385 2738 c-218 -53 -266 -70 -570 -209 -225 -103 -238 -111 -257 -149 -23 -47 -11 -90 47 -169 43 -59 117 -113 174 -128 30 -7 268 112 338 170 25 20 54 37 64 37 11 0 36 8 57 19 37 18 179 56 327 87 121 25 255 7 255 -35 0 -30 -75 -169 -129 -241 -64 -85 -300 -333 -522 -549 -96 -94 -206 -208 -245 -253 -38 -45 -116 -131 -174 -192 -158 -167 -413 -469 -438 -519 -19 -38 -10 -74 39 -158 56 -97 92 -135 144 -152 39 -14 51 -14 107 -1 35 8 88 30 119 49 94 57 280 153 354 180 145 55 418 116 602 134 73 8 103 22 103 48 0 10 7 14 20 10 13 -3 30 5 51 24 17 16 37 29 45 29 9 0 14 11 14 30 0 35 22 40 53 12 19 -16 20 -16 8 5 -6 13 -23 26 -36 29 -20 5 -25 12 -25 38 0 38 -31 72 -81 87 -19 6 -112 13 -208 16 -185 6 -276 -2 -439 -39 -51 -12 -95 -18 -98 -15 -9 8 171 200 465 496 310 314 483 521 545 653 23 51 31 150 17 223 -18 96 -66 180 -156 271 -84 85 -152 128 -254 158 -61 18 -249 21 -316 4z m311 -47 c33 -10 79 -29 104 -42 61 -32 196 -162 217 -210 9 -21 20 -39 24 -39 4 0 13 -26 19 -57 6 -32 15 -72 19 -89 11 -42 -10 -137 -45 -199 -22 -40 -75 -115 -141 -200 -31 -39 -142 -163 -160 -178 -13 -10 -23 -24 -23 -32 0 -7 -11 -20 -25 -29 -36 -24 -185 -172 -185 -185 0 -6 -8 -15 -18 -20 -24 -13 -209 -198 -311 -310 -42 -47 -93 -100 -113 -119 -21 -19 -38 -39 -38 -44 0 -6 -19 -27 -42 -48 -24 -21 -40 -42 -35 -46 4 -4 38 3 74 15 197 68 384 95 588 87 236 -9 275 -19 275 -71 0 -21 -2 -22 -47 -13 -52 9 -97 3 -88 -12 3 -6 19 -10 35 -10 16 0 31 -4 34 -9 3 -5 15 -7 25 -4 22 5 61 -13 61 -28 0 -6 -9 -8 -19 -4 -13 4 -23 0 -31 -12 -8 -13 -13 -14 -16 -5 -3 6 -12 12 -20 12 -8 0 -17 7 -21 16 -5 15 -7 15 -15 0 -7 -13 -28 -16 -109 -16 -76 0 -100 -3 -96 -12 3 -10 35 -12 120 -11 89 2 117 -1 117 -11 0 -7 -16 -18 -35 -26 -19 -8 -35 -17 -35 -22 0 -12 -108 -10 -115 3 -5 7 -14 4 -25 -9 -14 -15 -38 -21 -97 -26 -43 -4 -89 -11 -103 -16 -14 -4 -59 -16 -100 -25 -41 -10 -121 -33 -176 -51 -56 -19 -107 -34 -114 -34 -8 0 -21 -7 -30 -15 -15 -14 -97 -58 -295 -158 -90 -46 -157 -66 -163 -49 -2 7 -13 12 -23 12 -19 0 -89 66 -89 84 0 4 -16 34 -35 66 -19 32 -35 68 -35 80 0 12 25 50 58 88 33 37 66 77 74 90 8 12 44 55 79 94 35 39 69 78 75 87 7 9 30 36 53 60 23 24 41 47 41 51 0 4 10 12 23 19 12 6 33 27 46 46 13 19 39 44 57 56 19 11 37 31 40 43 3 13 30 47 60 77 30 29 54 59 54 66 0 7 4 13 8 13 23 0 626 619 717 734 56 72 135 219 135 252 0 8 4 23 9 33 5 9 7 22 3 28 -10 16 -126 43 -183 43 -40 0 -49 3 -49 18 -1 16 -2 16 -14 -1 -9 -12 -47 -25 -108 -38 -51 -11 -109 -24 -128 -29 -19 -5 -53 -13 -75 -18 -22 -5 -59 -18 -82 -30 -43 -23 -113 -30 -113 -12 0 6 -5 10 -11 10 -8 0 -7 -5 1 -16 11 -13 9 -20 -16 -44 -45 -44 -296 -176 -316 -166 -56 26 -112 68 -140 106 -81 111 -79 140 15 183 21 9 42 17 48 17 8 0 186 82 272 126 16 8 37 14 46 14 10 0 26 9 35 19 10 10 33 22 53 26 19 3 43 10 52 15 26 14 143 49 181 54 19 3 49 9 65 15 55 17 227 13 291 -8z" /> <path d="M1015 2311 c-10 -17 12 -21 25 -6 10 12 10 15 -3 15 -9 0 -18 -4 -22 -9z" /> <path d="M1928 2042 c-10 -2 -18 -12 -18 -23 0 -23 13 -25 30 -4 15 19 10 32 -12 27z" />
                                                    <path d="M1830 2020 c0 -11 4 -20 9 -20 11 0 22 26 14 34 -12 12 -23 5 -23 -14z" /> <path d="M1875 1970 c-3 -11 -10 -20 -14 -20 -4 0 -13 -11 -19 -25 -6 -14 -18 -25 -26 -25 -7 0 -16 -9 -19 -20 -3 -11 -12 -20 -21 -20 -20 0 -21 -14 -2 -29 18 -15 53 18 81 77 13 28 25 41 35 39 11 -3 17 4 18 19 2 30 -24 32 -33 4z" /> <path d="M1638 1883 c-2 -5 -3 -20 -3 -35 0 -42 20 -38 22 5 2 32 -10 51 -19 30z" /> <path d="M1637 1794 c-9 -9 4 -35 14 -28 5 3 9 12 9 20 0 14 -12 19 -23 8z" /> <path d="M1693 1774 c-13 -14 -23 -28 -23 -30 0 -9 79 -3 85 6 3 6 -1 10 -10 10 -12 0 -15 6 -10 20 9 29 -15 25 -42 -6z" /> <path d="M1548 1766 c-18 -13 -14 -26 8 -26 14 0 27 27 16 34 -4 2 -15 -1 -24 -8z" /> <path d="M1495 1720 c-8 -12 20 -24 35 -15 6 3 8 11 5 16 -8 12 -32 12 -40 -1z" /> <path d="M1640 1704 c0 -9 7 -14 17 -12 25 5 28 28 4 28 -12 0 -21 -6 -21 -16z" /> <path d="M1579 1653 c-50 -56 -54 -63 -30 -63 11 0 21 6 21 13 0 8 16 22 35 33 35 19 41 37 14 42 -8 1 -26 -10 -40 -25z" /> <path d="M1465 1619 c-10 -15 3 -25 16 -12 7 7 7 13 1 17 -6 3 -14 1 -17 -5z" /> <path d="M1299 1584 c-12 -14 -11 -16 5 -13 11 2 21 10 24 17 5 17 -13 15 -29 -4z" /> <path d="M1482 1555 c-38 -32 -41 -45 -9 -45 15 0 29 9 36 24 22 41 9 51 -27 21z" /> <path d="M1422 1559 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z" /> <path d="M1342 1528 c-17 -17 -15 -28 6 -28 19 0 42 18 42 32 0 12 -35 9 -48 -4z" /> <path d="M1429 1481 c-49 -31 -101 -79 -98 -90 3 -7 19 -1 41 14 20 14 50 25 67 25 16 0 33 5 36 10 4 6 -5 10 -21 10 -26 0 -27 0 -9 20 24 26 17 31 -16 11z" /> <path d="M1273 1473 c-7 -2 -13 -11 -13 -20 0 -20 34 -12 38 10 3 17 -3 20 -25 10z" /> <path d="M1186 1446 c7 -17 54 -23 54 -6 0 6 -6 10 -14 10 -8 0 -22 3 -30 6 -12 5 -15 2 -10 -10z" /> <path d="M1182 1388 c6 -18 28 -21 28 -4 0 9 -7 16 -16 16 -9 0 -14 -5 -12 -12z" /> <path d="M1330 1359 c0 -6 -7 -8 -16 -5 -17 6 -44 -9 -44 -25 0 -5 13 -9 29 -9 31 0 65 25 56 41 -8 13 -25 11 -25 -2z" /> <path d="M1035 1309 c-4 -6 -5 -13 -2 -16 7 -7 27 6 27 18 0 12 -17 12 -25 -2z" /> <path d="M1237 1314 c-8 -8 1 -24 14 -24 5 0 9 7 9 15 0 15 -12 20 -23 9z" /> <path d="M1145 1289 c-10 -15 3 -25 16 -12 7 7 7 13 1 17 -6 3 -14 1 -17 -5z" /> <path d="M1198 1267 c-31 -24 -168 -190 -168 -203 0 -8 -9 -14 -19 -14 -20 0 -101 -84 -101 -105 0 -22 13 -25 28 -4 11 16 17 17 28 8 9 -7 14 -8 14 -1 0 6 -5 14 -11 18 -7 4 -1 17 17 35 21 22 33 27 52 22 23 -5 24 -4 18 20 -5 20 1 33 30 64 92 98 120 123 137 123 13 0 17 6 15 22 -4 26 -18 31 -40 15z" /> <path d="M1047 1238 c-18 -9 -24 -38 -8 -38 5 0 19 8 31 18 18 15 20 20 8 24 -8 3 -22 2 -31 -4z" /> <path d="M978 1193 c-14 -2 -29 -11 -32 -20 -8 -21 1 -30 16 -15 7 7 23 12 36 12 21 0 23 -2 12 -15 -15 -18 -7 -30 14 -22 20 8 16 61 -4 63 -8 1 -27 -1 -42 -3z" /> <path d="M870 1060 c0 -12 50 -33 58 -25 7 7 -29 34 -45 35 -7 0 -13 -5 -13 -10z" /> <path d="M797 1034 c-10 -11 3 -24 24 -24 10 0 19 7 19 15 0 15 -31 21 -43 9z" /> <path d="M766 954 c-9 -24 -8 -24 19 -12 14 6 25 15 25 20 0 15 -38 8 -44 -8z" /> <path d="M785 920 c-3 -5 -12 -7 -20 -3 -8 3 -15 0 -15 -6 0 -6 -7 -11 -15 -11 -8 0 -15 -4 -15 -9 0 -16 21 -24 33 -12 6 6 21 11 34 11 16 0 23 6 23 20 0 21 -15 27 -25 10z" /> <path d="M852 889 c-7 -12 -12 -22 -10 -22 2 -1 14 -8 26 -15 27 -15 42 -8 24 10 -7 7 -12 20 -12 30 0 24 -12 23 -28 -3z" /> <path d="M1656 864 c-4 -9 -4 -19 -1 -23 8 -7 38 12 43 27 6 19 -35 14 -42 -4z" />
                                                    <path d="M722 836 c1 -10 8 -17 13 -17 15 1 12 24 -3 29 -9 3 -13 -2 -10 -12z" /> <path d="M805 840 c-8 -13 3 -50 16 -50 5 0 9 9 9 20 0 11 0 23 1 27 1 12 -19 15 -26 3z" /> <path d="M1548 839 c-16 -9 -26 -39 -13 -39 15 0 54 33 49 41 -7 11 -15 11 -36 -2z" /> <path d="M675 820 c-4 -6 -15 -8 -26 -5 -13 4 -19 2 -19 -9 0 -11 9 -16 29 -16 29 0 57 21 44 33 -9 10 -21 8 -28 -3z" /> <path d="M1395 820 c-4 -6 -3 -16 3 -22 6 -6 12 -6 17 2 4 6 3 16 -3 22 -6 6 -12 6 -17 -2z" /> <path d="M757 784 c-11 -14 -16 -28 -13 -31 7 -7 56 36 56 49 0 17 -26 6 -43 -18z" /> <path d="M1182 799 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z" /> <path d="M663 761 c-13 -21 -8 -32 13 -24 14 5 20 43 6 43 -4 0 -13 -9 -19 -19z" />
                                                    <path d="M1120 765 c0 -8 5 -15 10 -15 6 0 10 7 10 15 0 8 -4 15 -10 15 -5 0 -10 -7 -10 -15z" /> <path d="M1510 770 c-12 -8 -9 -10 13 -10 15 0 27 5 27 10 0 13 -20 13 -40 0z" /> <path d="M1315 749 c-4 -6 -5 -13 -2 -16 7 -7 27 6 27 18 0 12 -17 12 -25 -2z" /> <path d="M1263 743 c-18 -7 -16 -23 2 -23 8 0 15 7 15 15 0 8 -1 15 -2 14 -2 0 -9 -3 -15 -6z" /> <path d="M1404 726 c-22 -17 -13 -32 13 -21 10 4 37 7 61 7 30 0 42 4 42 14 0 19 -89 19 -116 0z" /> <path d="M1530 730 c0 -5 11 -10 25 -10 14 0 25 5 25 10 0 6 -11 10 -25 10 -14 0 -25 -4 -25 -10z" /> <path d="M1342 699 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z" /> <path d="M1236 675 c-3 -9 0 -15 9 -15 8 0 15 7 15 15 0 8 -4 15 -9 15 -5 0 -11 -7 -15 -15z" /> <path d="M1136 672 c-9 -15 16 -42 38 -42 9 0 16 7 16 15 0 8 -9 15 -19 15 -11 0 -21 5 -23 12 -3 9 -6 9 -12 0z" /> <path d="M1050 620 c0 -15 7 -20 29 -20 17 0 31 6 35 16 9 24 7 28 -8 15 -10 -8 -16 -9 -21 -1 -11 18 -35 11 -35 -10z" /> <path d="M936 584 c-5 -12 -2 -15 10 -10 8 3 20 6 25 6 5 0 9 5 9 10 0 16 -37 11 -44 -6z" /> <path d="M891 546 c-8 -10 -9 -16 -1 -21 5 -3 13 1 16 10 9 22 -1 29 -15 11z" /> <path d="M740 540 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z" /> <path d="M835 511 c-3 -5 -1 -12 4 -15 12 -8 41 3 41 15 0 12 -37 12 -45 0z" /> <path d="M720 440 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z" /> <path d="M1948 783 c-10 -2 -18 -9 -18 -14 0 -14 16 -11 30 6 7 8 11 14 9 14 -2 -1 -12 -3 -21 -6z" />
                                                </g>
                                            </svg>
                                        </div>
                                        <div class="message-content">
                                            <div class="message-bubble">
                                                <p>
                                                    @Html.Raw((item.Response ?? "Xin chào! 👋 Tôi là trợ lý AI của bạn.").Replace("\n", "<br/>"))
                                                </p>
                                            </div>
                                            <div class="message-time" data-time="now">
                                                @(item.CreatedAt.ToString("HH:mm") ?? "Just now")
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                        }
                        else{
                            <div class="message bot-message">
                                <div class="message-avatar">
                                    <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="280.000000pt" height="340.000000pt" viewBox="0 0 240.000000 300.000000" preserveAspectRatio="xMidYMid meet">
                                        <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
                                            <path d="M1385 2738 c-218 -53 -266 -70 -570 -209 -225 -103 -238 -111 -257 -149 -23 -47 -11 -90 47 -169 43 -59 117 -113 174 -128 30 -7 268 112 338 170 25 20 54 37 64 37 11 0 36 8 57 19 37 18 179 56 327 87 121 25 255 7 255 -35 0 -30 -75 -169 -129 -241 -64 -85 -300 -333 -522 -549 -96 -94 -206 -208 -245 -253 -38 -45 -116 -131 -174 -192 -158 -167 -413 -469 -438 -519 -19 -38 -10 -74 39 -158 56 -97 92 -135 144 -152 39 -14 51 -14 107 -1 35 8 88 30 119 49 94 57 280 153 354 180 145 55 418 116 602 134 73 8 103 22 103 48 0 10 7 14 20 10 13 -3 30 5 51 24 17 16 37 29 45 29 9 0 14 11 14 30 0 35 22 40 53 12 19 -16 20 -16 8 5 -6 13 -23 26 -36 29 -20 5 -25 12 -25 38 0 38 -31 72 -81 87 -19 6 -112 13 -208 16 -185 6 -276 -2 -439 -39 -51 -12 -95 -18 -98 -15 -9 8 171 200 465 496 310 314 483 521 545 653 23 51 31 150 17 223 -18 96 -66 180 -156 271 -84 85 -152 128 -254 158 -61 18 -249 21 -316 4z m311 -47 c33 -10 79 -29 104 -42 61 -32 196 -162 217 -210 9 -21 20 -39 24 -39 4 0 13 -26 19 -57 6 -32 15 -72 19 -89 11 -42 -10 -137 -45 -199 -22 -40 -75 -115 -141 -200 -31 -39 -142 -163 -160 -178 -13 -10 -23 -24 -23 -32 0 -7 -11 -20 -25 -29 -36 -24 -185 -172 -185 -185 0 -6 -8 -15 -18 -20 -24 -13 -209 -198 -311 -310 -42 -47 -93 -100 -113 -119 -21 -19 -38 -39 -38 -44 0 -6 -19 -27 -42 -48 -24 -21 -40 -42 -35 -46 4 -4 38 3 74 15 197 68 384 95 588 87 236 -9 275 -19 275 -71 0 -21 -2 -22 -47 -13 -52 9 -97 3 -88 -12 3 -6 19 -10 35 -10 16 0 31 -4 34 -9 3 -5 15 -7 25 -4 22 5 61 -13 61 -28 0 -6 -9 -8 -19 -4 -13 4 -23 0 -31 -12 -8 -13 -13 -14 -16 -5 -3 6 -12 12 -20 12 -8 0 -17 7 -21 16 -5 15 -7 15 -15 0 -7 -13 -28 -16 -109 -16 -76 0 -100 -3 -96 -12 3 -10 35 -12 120 -11 89 2 117 -1 117 -11 0 -7 -16 -18 -35 -26 -19 -8 -35 -17 -35 -22 0 -12 -108 -10 -115 3 -5 7 -14 4 -25 -9 -14 -15 -38 -21 -97 -26 -43 -4 -89 -11 -103 -16 -14 -4 -59 -16 -100 -25 -41 -10 -121 -33 -176 -51 -56 -19 -107 -34 -114 -34 -8 0 -21 -7 -30 -15 -15 -14 -97 -58 -295 -158 -90 -46 -157 -66 -163 -49 -2 7 -13 12 -23 12 -19 0 -89 66 -89 84 0 4 -16 34 -35 66 -19 32 -35 68 -35 80 0 12 25 50 58 88 33 37 66 77 74 90 8 12 44 55 79 94 35 39 69 78 75 87 7 9 30 36 53 60 23 24 41 47 41 51 0 4 10 12 23 19 12 6 33 27 46 46 13 19 39 44 57 56 19 11 37 31 40 43 3 13 30 47 60 77 30 29 54 59 54 66 0 7 4 13 8 13 23 0 626 619 717 734 56 72 135 219 135 252 0 8 4 23 9 33 5 9 7 22 3 28 -10 16 -126 43 -183 43 -40 0 -49 3 -49 18 -1 16 -2 16 -14 -1 -9 -12 -47 -25 -108 -38 -51 -11 -109 -24 -128 -29 -19 -5 -53 -13 -75 -18 -22 -5 -59 -18 -82 -30 -43 -23 -113 -30 -113 -12 0 6 -5 10 -11 10 -8 0 -7 -5 1 -16 11 -13 9 -20 -16 -44 -45 -44 -296 -176 -316 -166 -56 26 -112 68 -140 106 -81 111 -79 140 15 183 21 9 42 17 48 17 8 0 186 82 272 126 16 8 37 14 46 14 10 0 26 9 35 19 10 10 33 22 53 26 19 3 43 10 52 15 26 14 143 49 181 54 19 3 49 9 65 15 55 17 227 13 291 -8z" /> <path d="M1015 2311 c-10 -17 12 -21 25 -6 10 12 10 15 -3 15 -9 0 -18 -4 -22 -9z" /> <path d="M1928 2042 c-10 -2 -18 -12 -18 -23 0 -23 13 -25 30 -4 15 19 10 32 -12 27z" />
                                            <path d="M1830 2020 c0 -11 4 -20 9 -20 11 0 22 26 14 34 -12 12 -23 5 -23 -14z" /> <path d="M1875 1970 c-3 -11 -10 -20 -14 -20 -4 0 -13 -11 -19 -25 -6 -14 -18 -25 -26 -25 -7 0 -16 -9 -19 -20 -3 -11 -12 -20 -21 -20 -20 0 -21 -14 -2 -29 18 -15 53 18 81 77 13 28 25 41 35 39 11 -3 17 4 18 19 2 30 -24 32 -33 4z" /> <path d="M1638 1883 c-2 -5 -3 -20 -3 -35 0 -42 20 -38 22 5 2 32 -10 51 -19 30z" /> <path d="M1637 1794 c-9 -9 4 -35 14 -28 5 3 9 12 9 20 0 14 -12 19 -23 8z" /> <path d="M1693 1774 c-13 -14 -23 -28 -23 -30 0 -9 79 -3 85 6 3 6 -1 10 -10 10 -12 0 -15 6 -10 20 9 29 -15 25 -42 -6z" /> <path d="M1548 1766 c-18 -13 -14 -26 8 -26 14 0 27 27 16 34 -4 2 -15 -1 -24 -8z" /> <path d="M1495 1720 c-8 -12 20 -24 35 -15 6 3 8 11 5 16 -8 12 -32 12 -40 -1z" /> <path d="M1640 1704 c0 -9 7 -14 17 -12 25 5 28 28 4 28 -12 0 -21 -6 -21 -16z" /> <path d="M1579 1653 c-50 -56 -54 -63 -30 -63 11 0 21 6 21 13 0 8 16 22 35 33 35 19 41 37 14 42 -8 1 -26 -10 -40 -25z" /> <path d="M1465 1619 c-10 -15 3 -25 16 -12 7 7 7 13 1 17 -6 3 -14 1 -17 -5z" /> <path d="M1299 1584 c-12 -14 -11 -16 5 -13 11 2 21 10 24 17 5 17 -13 15 -29 -4z" /> <path d="M1482 1555 c-38 -32 -41 -45 -9 -45 15 0 29 9 36 24 22 41 9 51 -27 21z" /> <path d="M1422 1559 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z" /> <path d="M1342 1528 c-17 -17 -15 -28 6 -28 19 0 42 18 42 32 0 12 -35 9 -48 -4z" /> <path d="M1429 1481 c-49 -31 -101 -79 -98 -90 3 -7 19 -1 41 14 20 14 50 25 67 25 16 0 33 5 36 10 4 6 -5 10 -21 10 -26 0 -27 0 -9 20 24 26 17 31 -16 11z" /> <path d="M1273 1473 c-7 -2 -13 -11 -13 -20 0 -20 34 -12 38 10 3 17 -3 20 -25 10z" /> <path d="M1186 1446 c7 -17 54 -23 54 -6 0 6 -6 10 -14 10 -8 0 -22 3 -30 6 -12 5 -15 2 -10 -10z" /> <path d="M1182 1388 c6 -18 28 -21 28 -4 0 9 -7 16 -16 16 -9 0 -14 -5 -12 -12z" /> <path d="M1330 1359 c0 -6 -7 -8 -16 -5 -17 6 -44 -9 -44 -25 0 -5 13 -9 29 -9 31 0 65 25 56 41 -8 13 -25 11 -25 -2z" /> <path d="M1035 1309 c-4 -6 -5 -13 -2 -16 7 -7 27 6 27 18 0 12 -17 12 -25 -2z" /> <path d="M1237 1314 c-8 -8 1 -24 14 -24 5 0 9 7 9 15 0 15 -12 20 -23 9z" /> <path d="M1145 1289 c-10 -15 3 -25 16 -12 7 7 7 13 1 17 -6 3 -14 1 -17 -5z" /> <path d="M1198 1267 c-31 -24 -168 -190 -168 -203 0 -8 -9 -14 -19 -14 -20 0 -101 -84 -101 -105 0 -22 13 -25 28 -4 11 16 17 17 28 8 9 -7 14 -8 14 -1 0 6 -5 14 -11 18 -7 4 -1 17 17 35 21 22 33 27 52 22 23 -5 24 -4 18 20 -5 20 1 33 30 64 92 98 120 123 137 123 13 0 17 6 15 22 -4 26 -18 31 -40 15z" /> <path d="M1047 1238 c-18 -9 -24 -38 -8 -38 5 0 19 8 31 18 18 15 20 20 8 24 -8 3 -22 2 -31 -4z" /> <path d="M978 1193 c-14 -2 -29 -11 -32 -20 -8 -21 1 -30 16 -15 7 7 23 12 36 12 21 0 23 -2 12 -15 -15 -18 -7 -30 14 -22 20 8 16 61 -4 63 -8 1 -27 -1 -42 -3z" /> <path d="M870 1060 c0 -12 50 -33 58 -25 7 7 -29 34 -45 35 -7 0 -13 -5 -13 -10z" /> <path d="M797 1034 c-10 -11 3 -24 24 -24 10 0 19 7 19 15 0 15 -31 21 -43 9z" /> <path d="M766 954 c-9 -24 -8 -24 19 -12 14 6 25 15 25 20 0 15 -38 8 -44 -8z" /> <path d="M785 920 c-3 -5 -12 -7 -20 -3 -8 3 -15 0 -15 -6 0 -6 -7 -11 -15 -11 -8 0 -15 -4 -15 -9 0 -16 21 -24 33 -12 6 6 21 11 34 11 16 0 23 6 23 20 0 21 -15 27 -25 10z" /> <path d="M852 889 c-7 -12 -12 -22 -10 -22 2 -1 14 -8 26 -15 27 -15 42 -8 24 10 -7 7 -12 20 -12 30 0 24 -12 23 -28 -3z" /> <path d="M1656 864 c-4 -9 -4 -19 -1 -23 8 -7 38 12 43 27 6 19 -35 14 -42 -4z" />
                                            <path d="M722 836 c1 -10 8 -17 13 -17 15 1 12 24 -3 29 -9 3 -13 -2 -10 -12z" /> <path d="M805 840 c-8 -13 3 -50 16 -50 5 0 9 9 9 20 0 11 0 23 1 27 1 12 -19 15 -26 3z" /> <path d="M1548 839 c-16 -9 -26 -39 -13 -39 15 0 54 33 49 41 -7 11 -15 11 -36 -2z" /> <path d="M675 820 c-4 -6 -15 -8 -26 -5 -13 4 -19 2 -19 -9 0 -11 9 -16 29 -16 29 0 57 21 44 33 -9 10 -21 8 -28 -3z" /> <path d="M1395 820 c-4 -6 -3 -16 3 -22 6 -6 12 -6 17 2 4 6 3 16 -3 22 -6 6 -12 6 -17 -2z" /> <path d="M757 784 c-11 -14 -16 -28 -13 -31 7 -7 56 36 56 49 0 17 -26 6 -43 -18z" /> <path d="M1182 799 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z" /> <path d="M663 761 c-13 -21 -8 -32 13 -24 14 5 20 43 6 43 -4 0 -13 -9 -19 -19z" />
                                            <path d="M1120 765 c0 -8 5 -15 10 -15 6 0 10 7 10 15 0 8 -4 15 -10 15 -5 0 -10 -7 -10 -15z" /> <path d="M1510 770 c-12 -8 -9 -10 13 -10 15 0 27 5 27 10 0 13 -20 13 -40 0z" /> <path d="M1315 749 c-4 -6 -5 -13 -2 -16 7 -7 27 6 27 18 0 12 -17 12 -25 -2z" /> <path d="M1263 743 c-18 -7 -16 -23 2 -23 8 0 15 7 15 15 0 8 -1 15 -2 14 -2 0 -9 -3 -15 -6z" /> <path d="M1404 726 c-22 -17 -13 -32 13 -21 10 4 37 7 61 7 30 0 42 4 42 14 0 19 -89 19 -116 0z" /> <path d="M1530 730 c0 -5 11 -10 25 -10 14 0 25 5 25 10 0 6 -11 10 -25 10 -14 0 -25 -4 -25 -10z" /> <path d="M1342 699 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z" /> <path d="M1236 675 c-3 -9 0 -15 9 -15 8 0 15 7 15 15 0 8 -4 15 -9 15 -5 0 -11 -7 -15 -15z" /> <path d="M1136 672 c-9 -15 16 -42 38 -42 9 0 16 7 16 15 0 8 -9 15 -19 15 -11 0 -21 5 -23 12 -3 9 -6 9 -12 0z" /> <path d="M1050 620 c0 -15 7 -20 29 -20 17 0 31 6 35 16 9 24 7 28 -8 15 -10 -8 -16 -9 -21 -1 -11 18 -35 11 -35 -10z" /> <path d="M936 584 c-5 -12 -2 -15 10 -10 8 3 20 6 25 6 5 0 9 5 9 10 0 16 -37 11 -44 -6z" /> <path d="M891 546 c-8 -10 -9 -16 -1 -21 5 -3 13 1 16 10 9 22 -1 29 -15 11z" /> <path d="M740 540 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z" /> <path d="M835 511 c-3 -5 -1 -12 4 -15 12 -8 41 3 41 15 0 12 -37 12 -45 0z" /> <path d="M720 440 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z" /> <path d="M1948 783 c-10 -2 -18 -9 -18 -14 0 -14 16 -11 30 6 7 8 11 14 9 14 -2 -1 -12 -3 -21 -6z" />
                                        </g>
                                    </svg>
                                </div>
                                <div class="message-content">
                                    <div class="message-bubble">
                                        <p>Xin chào! 👋 Tôi là trợ lý AI của bạn.</p>
                                    </div>
                                    <div class="message-time" data-time="now">Just now</div>
                                </div>
                            </div>
                        }
                        <div class="message-avatar" style="position:fixed; bottom:80px; right:20px; border: 1px solid black;" id="scrollBtn" onclick="scrollToBottom()">
                            <svg fill="#000000" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier">
                                <path d="M6.293,17.707a1,1,0,0,1,1.414-1.414L11,19.586V2a1,1,0,0,1,2,0V19.586l3.293-3.293a1,1,0,0,1,1.414,1.414l-5,5a1,1,0,0,1-1.414,0Z"></path></g>
                            </svg>
                        </div>
                    </div>

                    <!-- Typing Indicator -->
                    <div class="typing-indicator" id="typingIndicator">
                        <div class="message-avatar">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="8" r="5" />
                                <path d="M20 21a8 8 0 1 0-16 0" />
                            </svg>
                        </div>
                        <div class="typing-bubble">
                            <div class="typing-dots">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Input -->
                    <div class="chat-input">
                        <div class="input-container">
                            <input type="text"
                                   id="messageInput"
                                   placeholder="Hỏi chúng tôi bất cứ điều gì..."
                                   autocomplete="off">
                            <button class="send-btn" id="sendBtn" aria-label="Send Message">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="22" y1="2" x2="11" y2="13" />
                                    <polygon points="22,2 15,22 11,13 2,9 22,2" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <script>
                class ChatBot {
                    constructor() {
                        this.isOpen = false;
                        this.isTyping = false;
                        this.init();
                    }

                    init() {
                        this.bindEvents();
                    }

                    bindEvents() {
                        document.getElementById('chatToggle')?.addEventListener('click', () => this.toggleChat());
                        document.getElementById('minimizeBtn')?.addEventListener('click', () => this.toggleChat());
                        document.getElementById('sendBtn')?.addEventListener('click', () => this.sendMessage());

                        const messageInput = document.getElementById('messageInput');
                        messageInput?.addEventListener('keypress', (e) => {
                            if (e.key === 'Enter' && !e.shiftKey) {
                                e.preventDefault();
                                this.sendMessage();
                            }
                        });
                    }

                    toggleChat() {
                        const widget = document.getElementById('chatbotWidget');
                        this.isOpen = !this.isOpen;
                        widget?.classList.toggle('open', this.isOpen);
                    }

                    async sendMessage() {
                        const messageInput = document.getElementById('messageInput');
                        const message = messageInput.value.trim();
                        if (!message || this.isTyping) return;

                        messageInput.value = '';
                        this.addMessage(message, 'user');
                        this.showTyping();

                        console.log('prompt là', message);

                        $.ajax({
                            url: '/Home/SendPrompt',
                            type: 'POST',
                            data: { prompt: message },
                            success: (data) => {
                                this.hideTyping();
                                this.addMessage(data.response, 'bot');
                            },
                            error: (xhr, status, error) => {
                                this.hideTyping();
                                this.addMessage("Xin lỗi, có lỗi khi kết nối server!", 'bot');
                            }
                        });
                    }

                    addMessage(text, sender) {
                        const messagesContainer = document.getElementById('chatMessages');
                        const messageDiv = document.createElement('div');
                        messageDiv.className = `message ${sender}-message`;

                        const formattedText = text.replace(/\n/g, '<br/>');
                        if(sender === "bot"){
                            messageDiv.innerHTML = `
                                        <div class="message bot-message">
                                            <div class="message-avatar">
                                                 <svg version="1.0" xmlns="http://www.w3.org/2000/svg"  width="280.000000pt" height="340.000000pt" viewBox="0 0 240.000000 300.000000"  preserveAspectRatio="xMidYMid meet">  <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none"> <path d="M1385 2738 c-218 -53 -266 -70 -570 -209 -225 -103 -238 -111 -257 -149 -23 -47 -11 -90 47 -169 43 -59 117 -113 174 -128 30 -7 268 112 338 170 25 20 54 37 64 37 11 0 36 8 57 19 37 18 179 56 327 87 121 25 255 7 255 -35 0 -30 -75 -169 -129 -241 -64 -85 -300 -333 -522 -549 -96 -94 -206 -208 -245 -253 -38 -45 -116 -131 -174 -192 -158 -167 -413 -469 -438 -519 -19 -38 -10 -74 39 -158 56 -97 92 -135 144 -152 39 -14 51 -14 107 -1 35 8 88 30 119 49 94 57 280 153 354 180 145 55 418 116 602 134 73 8 103 22 103 48 0 10 7 14 20 10 13 -3 30 5 51 24 17 16 37 29 45 29 9 0 14 11 14 30 0 35 22 40 53 12 19 -16 20 -16 8 5 -6 13 -23 26 -36 29 -20 5 -25 12 -25 38 0 38 -31 72 -81 87 -19 6 -112 13 -208 16 -185 6 -276 -2 -439 -39 -51 -12 -95 -18 -98 -15 -9 8 171 200 465 496 310 314 483 521 545 653 23 51 31 150 17 223 -18 96 -66 180 -156 271 -84 85 -152 128 -254 158 -61 18 -249 21 -316 4z m311 -47 c33 -10 79 -29 104 -42 61 -32 196 -162 217 -210 9 -21 20 -39 24 -39 4 0 13 -26 19 -57 6 -32 15 -72 19 -89 11 -42 -10 -137 -45 -199 -22 -40 -75 -115 -141 -200 -31 -39 -142 -163 -160 -178 -13 -10 -23 -24 -23 -32 0 -7 -11 -20 -25 -29 -36 -24 -185 -172 -185 -185 0 -6 -8 -15 -18 -20 -24 -13 -209 -198 -311 -310 -42 -47 -93 -100 -113 -119 -21 -19 -38 -39 -38 -44 0 -6 -19 -27 -42 -48 -24 -21 -40 -42 -35 -46 4 -4 38 3 74 15 197 68 384 95 588 87 236 -9 275 -19 275 -71 0 -21 -2 -22 -47 -13 -52 9 -97 3 -88 -12 3 -6 19 -10 35 -10 16 0 31 -4 34 -9 3 -5 15 -7 25 -4 22 5 61 -13 61 -28 0 -6 -9 -8 -19 -4 -13 4 -23 0 -31 -12 -8 -13 -13 -14 -16 -5 -3 6 -12 12 -20 12 -8 0 -17 7 -21 16 -5 15 -7 15 -15 0 -7 -13 -28 -16 -109 -16 -76 0 -100 -3 -96 -12 3 -10 35 -12 120 -11 89 2 117 -1 117 -11 0 -7 -16 -18 -35 -26 -19 -8 -35 -17 -35 -22 0 -12 -108 -10 -115 3 -5 7 -14 4 -25 -9 -14 -15 -38 -21 -97 -26 -43 -4 -89 -11 -103 -16 -14 -4 -59 -16 -100 -25 -41 -10 -121 -33 -176 -51 -56 -19 -107 -34 -114 -34 -8 0 -21 -7 -30 -15 -15 -14 -97 -58 -295 -158 -90 -46 -157 -66 -163 -49 -2 7 -13 12 -23 12 -19 0 -89 66 -89 84 0 4 -16 34 -35 66 -19 32 -35 68 -35 80 0 12 25 50 58 88 33 37 66 77 74 90 8 12 44 55 79 94 35 39 69 78 75 87 7 9 30 36 53 60 23 24 41 47 41 51 0 4 10 12 23 19 12 6 33 27 46 46 13 19 39 44 57 56 19 11 37 31 40 43 3 13 30 47 60 77 30 29 54 59 54 66 0 7 4 13 8 13 23 0 626 619 717 734 56 72 135 219 135 252 0 8 4 23 9 33 5 9 7 22 3 28 -10 16 -126 43 -183 43 -40 0 -49 3 -49 18 -1 16 -2 16 -14 -1 -9 -12 -47 -25 -108 -38 -51 -11 -109 -24 -128 -29 -19 -5 -53 -13 -75 -18 -22 -5 -59 -18 -82 -30 -43 -23 -113 -30 -113 -12 0 6 -5 10 -11 10 -8 0 -7 -5 1 -16 11 -13 9 -20 -16 -44 -45 -44 -296 -176 -316 -166 -56 26 -112 68 -140 106 -81 111 -79 140 15 183 21 9 42 17 48 17 8 0 186 82 272 126 16 8 37 14 46 14 10 0 26 9 35 19 10 10 33 22 53 26 19 3 43 10 52 15 26 14 143 49 181 54 19 3 49 9 65 15 55 17 227 13 291 -8z"/> <path d="M1015 2311 c-10 -17 12 -21 25 -6 10 12 10 15 -3 15 -9 0 -18 -4 -22 -9z"/> <path d="M1928 2042 c-10 -2 -18 -12 -18 -23 0 -23 13 -25 30 -4 15 19 10 32 -12 27z"/>
                                                    <path d="M1830 2020 c0 -11 4 -20 9 -20 11 0 22 26 14 34 -12 12 -23 5 -23 -14z"/> <path d="M1875 1970 c-3 -11 -10 -20 -14 -20 -4 0 -13 -11 -19 -25 -6 -14 -18 -25 -26 -25 -7 0 -16 -9 -19 -20 -3 -11 -12 -20 -21 -20 -20 0 -21 -14 -2 -29 18 -15 53 18 81 77 13 28 25 41 35 39 11 -3 17 4 18 19 2 30 -24 32 -33 4z"/> <path d="M1638 1883 c-2 -5 -3 -20 -3 -35 0 -42 20 -38 22 5 2 32 -10 51 -19 30z"/> <path d="M1637 1794 c-9 -9 4 -35 14 -28 5 3 9 12 9 20 0 14 -12 19 -23 8z"/> <path d="M1693 1774 c-13 -14 -23 -28 -23 -30 0 -9 79 -3 85 6 3 6 -1 10 -10 10 -12 0 -15 6 -10 20 9 29 -15 25 -42 -6z"/> <path d="M1548 1766 c-18 -13 -14 -26 8 -26 14 0 27 27 16 34 -4 2 -15 -1 -24 -8z"/> <path d="M1495 1720 c-8 -12 20 -24 35 -15 6 3 8 11 5 16 -8 12 -32 12 -40 -1z"/> <path d="M1640 1704 c0 -9 7 -14 17 -12 25 5 28 28 4 28 -12 0 -21 -6 -21 -16z"/> <path d="M1579 1653 c-50 -56 -54 -63 -30 -63 11 0 21 6 21 13 0 8 16 22 35 33 35 19 41 37 14 42 -8 1 -26 -10 -40 -25z"/> <path d="M1465 1619 c-10 -15 3 -25 16 -12 7 7 7 13 1 17 -6 3 -14 1 -17 -5z"/> <path d="M1299 1584 c-12 -14 -11 -16 5 -13 11 2 21 10 24 17 5 17 -13 15 -29 -4z"/> <path d="M1482 1555 c-38 -32 -41 -45 -9 -45 15 0 29 9 36 24 22 41 9 51 -27 21z"/> <path d="M1422 1559 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z"/> <path d="M1342 1528 c-17 -17 -15 -28 6 -28 19 0 42 18 42 32 0 12 -35 9 -48 -4z"/> <path d="M1429 1481 c-49 -31 -101 -79 -98 -90 3 -7 19 -1 41 14 20 14 50 25 67 25 16 0 33 5 36 10 4 6 -5 10 -21 10 -26 0 -27 0 -9 20 24 26 17 31 -16 11z"/> <path d="M1273 1473 c-7 -2 -13 -11 -13 -20 0 -20 34 -12 38 10 3 17 -3 20 -25 10z"/> <path d="M1186 1446 c7 -17 54 -23 54 -6 0 6 -6 10 -14 10 -8 0 -22 3 -30 6 -12 5 -15 2 -10 -10z"/> <path d="M1182 1388 c6 -18 28 -21 28 -4 0 9 -7 16 -16 16 -9 0 -14 -5 -12 -12z"/> <path d="M1330 1359 c0 -6 -7 -8 -16 -5 -17 6 -44 -9 -44 -25 0 -5 13 -9 29 -9 31 0 65 25 56 41 -8 13 -25 11 -25 -2z"/> <path d="M1035 1309 c-4 -6 -5 -13 -2 -16 7 -7 27 6 27 18 0 12 -17 12 -25 -2z"/> <path d="M1237 1314 c-8 -8 1 -24 14 -24 5 0 9 7 9 15 0 15 -12 20 -23 9z"/> <path d="M1145 1289 c-10 -15 3 -25 16 -12 7 7 7 13 1 17 -6 3 -14 1 -17 -5z"/> <path d="M1198 1267 c-31 -24 -168 -190 -168 -203 0 -8 -9 -14 -19 -14 -20 0 -101 -84 -101 -105 0 -22 13 -25 28 -4 11 16 17 17 28 8 9 -7 14 -8 14 -1 0 6 -5 14 -11 18 -7 4 -1 17 17 35 21 22 33 27 52 22 23 -5 24 -4 18 20 -5 20 1 33 30 64 92 98 120 123 137 123 13 0 17 6 15 22 -4 26 -18 31 -40 15z"/> <path d="M1047 1238 c-18 -9 -24 -38 -8 -38 5 0 19 8 31 18 18 15 20 20 8 24 -8 3 -22 2 -31 -4z"/> <path d="M978 1193 c-14 -2 -29 -11 -32 -20 -8 -21 1 -30 16 -15 7 7 23 12 36 12 21 0 23 -2 12 -15 -15 -18 -7 -30 14 -22 20 8 16 61 -4 63 -8 1 -27 -1 -42 -3z"/> <path d="M870 1060 c0 -12 50 -33 58 -25 7 7 -29 34 -45 35 -7 0 -13 -5 -13 -10z"/> <path d="M797 1034 c-10 -11 3 -24 24 -24 10 0 19 7 19 15 0 15 -31 21 -43 9z"/> <path d="M766 954 c-9 -24 -8 -24 19 -12 14 6 25 15 25 20 0 15 -38 8 -44 -8z"/> <path d="M785 920 c-3 -5 -12 -7 -20 -3 -8 3 -15 0 -15 -6 0 -6 -7 -11 -15 -11 -8 0 -15 -4 -15 -9 0 -16 21 -24 33 -12 6 6 21 11 34 11 16 0 23 6 23 20 0 21 -15 27 -25 10z"/> <path d="M852 889 c-7 -12 -12 -22 -10 -22 2 -1 14 -8 26 -15 27 -15 42 -8 24 10 -7 7 -12 20 -12 30 0 24 -12 23 -28 -3z"/> <path d="M1656 864 c-4 -9 -4 -19 -1 -23 8 -7 38 12 43 27 6 19 -35 14 -42 -4z"/>
                                                    <path d="M722 836 c1 -10 8 -17 13 -17 15 1 12 24 -3 29 -9 3 -13 -2 -10 -12z"/> <path d="M805 840 c-8 -13 3 -50 16 -50 5 0 9 9 9 20 0 11 0 23 1 27 1 12 -19 15 -26 3z"/> <path d="M1548 839 c-16 -9 -26 -39 -13 -39 15 0 54 33 49 41 -7 11 -15 11 -36 -2z"/> <path d="M675 820 c-4 -6 -15 -8 -26 -5 -13 4 -19 2 -19 -9 0 -11 9 -16 29 -16 29 0 57 21 44 33 -9 10 -21 8 -28 -3z"/> <path d="M1395 820 c-4 -6 -3 -16 3 -22 6 -6 12 -6 17 2 4 6 3 16 -3 22 -6 6 -12 6 -17 -2z"/> <path d="M757 784 c-11 -14 -16 -28 -13 -31 7 -7 56 36 56 49 0 17 -26 6 -43 -18z"/> <path d="M1182 799 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z"/> <path d="M663 761 c-13 -21 -8 -32 13 -24 14 5 20 43 6 43 -4 0 -13 -9 -19 -19z"/>
                                                    <path d="M1120 765 c0 -8 5 -15 10 -15 6 0 10 7 10 15 0 8 -4 15 -10 15 -5 0 -10 -7 -10 -15z"/> <path d="M1510 770 c-12 -8 -9 -10 13 -10 15 0 27 5 27 10 0 13 -20 13 -40 0z"/> <path d="M1315 749 c-4 -6 -5 -13 -2 -16 7 -7 27 6 27 18 0 12 -17 12 -25 -2z"/> <path d="M1263 743 c-18 -7 -16 -23 2 -23 8 0 15 7 15 15 0 8 -1 15 -2 14 -2 0 -9 -3 -15 -6z"/> <path d="M1404 726 c-22 -17 -13 -32 13 -21 10 4 37 7 61 7 30 0 42 4 42 14 0 19 -89 19 -116 0z"/> <path d="M1530 730 c0 -5 11 -10 25 -10 14 0 25 5 25 10 0 6 -11 10 -25 10 -14 0 -25 -4 -25 -10z"/> <path d="M1342 699 c2 -6 8 -10 13 -10 5 0 11 4 13 10 2 6 -4 11 -13 11 -9 0 -15 -5 -13 -11z"/> <path d="M1236 675 c-3 -9 0 -15 9 -15 8 0 15 7 15 15 0 8 -4 15 -9 15 -5 0 -11 -7 -15 -15z"/> <path d="M1136 672 c-9 -15 16 -42 38 -42 9 0 16 7 16 15 0 8 -9 15 -19 15 -11 0 -21 5 -23 12 -3 9 -6 9 -12 0z"/> <path d="M1050 620 c0 -15 7 -20 29 -20 17 0 31 6 35 16 9 24 7 28 -8 15 -10 -8 -16 -9 -21 -1 -11 18 -35 11 -35 -10z"/> <path d="M936 584 c-5 -12 -2 -15 10 -10 8 3 20 6 25 6 5 0 9 5 9 10 0 16 -37 11 -44 -6z"/> <path d="M891 546 c-8 -10 -9 -16 -1 -21 5 -3 13 1 16 10 9 22 -1 29 -15 11z"/> <path d="M740 540 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z"/> <path d="M835 511 c-3 -5 -1 -12 4 -15 12 -8 41 3 41 15 0 12 -37 12 -45 0z"/> <path d="M720 440 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z"/> <path d="M1948 783 c-10 -2 -18 -9 -18 -14 0 -14 16 -11 30 6 7 8 11 14 9 14 -2 -1 -12 -3 -21 -6z"/> </g> 
                                                 </svg>
                                            </div>
                                            <div class="message-content">
                                                 <div class="message-bubble">
                                                    <p>${formattedText}</p>
                                                 </div>
                                            </div>
                                        </div>
                            `;
                        }
                        else if(sender === "user"){
                            messageDiv.innerHTML = `
                                        <div class="message bot-message">
                                            <div class="message-content">
                                                 <div class="message-bubble">
                                                    <p class="mb-0" style="word-break: break-word;">${formattedText}</p>
                                                 </div>
                                            </div>
                                            <div class="message-avatar">
                                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                 <circle cx="12" cy="8" r="5" />
                                                    <path d="M20 21a8 8 0 1 0-16 0" />
                                                 </svg>
                                            </div>
                                        </div>
                            `;
                        }
                        messagesContainer.appendChild(messageDiv);
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    }

                    showTyping() {
                        this.isTyping = true;
                        document.getElementById('typingIndicator')?.classList.add('show');
                    }

                    hideTyping() {
                        this.isTyping = false;
                        document.getElementById('typingIndicator')?.classList.remove('show');
                    }
                }
                document.addEventListener('DOMContentLoaded', () => new ChatBot());
            </script>
            <script>
                function scrollToBottom() {
                        var chatMessages = document.getElementById("chatMessages");
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                }
                // ẩn nút khi dưới cuối
                document.getElementById("chatMessages").addEventListener("scroll", function() {
                    var chatMessages = this;
                    var btn = document.getElementById("scrollBtn");

                    if (chatMessages.scrollHeight - chatMessages.scrollTop <= chatMessages.clientHeight + 50) {
                        btn.style.opacity = "0";
                        btn.style.pointerEvents = "none";
                    } else {
                        btn.style.opacity = "1";
                        btn.style.pointerEvents = "auto";
                    }
                });
            </script>
        </div>
    </div>
    <div class="shell">
        <div class="container">
            <div class="tieude1" style="padding-bottom: 8px;">
                <h3>Có thể bạn quan tâm</h3>
            </div>
            <div class="row">
                @foreach (var item in shoesDetails.Take(4))
                {
                    <div class="col-md-3">
                        <div class="wsk-cp-product">
                            <div class="wsk-cp-img">
                                <img src="@Url.Content("~/image/" + item.ImageUrl)" alt="Product" class="img-responsive" />
                            </div>
                            <div class="wsk-cp-text">
                                <div class="category">
                                    <span>View</span>
                                </div>
                                <div class="title-product">
                                    <h3>@ViewBag.NameSP[item.ShoesDetailsId]</h3>
                                </div>
                                <div class="description-prod">
                                    <p>@item.Description</p>
                                </div>
                                <div class="card-footer" style="padding-left: 38px;">
                                    <div class="wcf-left">
                                        <span class="price" style="color: red; font-size: 16px;">
                                            @item.Price.ToString("N0")đ <del style="color: black; font-size: 16px;"> @item.ImportPrice.ToString("N0")đ</del>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
    <footer class="footer" style="margin-top: 200px;">
        <!-- Copyright -->
        <div class="text-center p-3" style="background-color: white; color: white;">
            © 2022
            <a class="text-white" href="#" style="text-decoration: none;">
                Nike, Inc. All Rights
                Reserved - PH24890
            </a>
        </div>
        <!-- Copyright -->
    </footer>
    <!-- <footer class="footer">My footer</footer> -->
</body>

</html>